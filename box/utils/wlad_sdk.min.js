! function() {
  var n, t, e = App,
    
    i = Page,
    o = require("./wlad_conf"),
    r = "log.51weiliang.com",
    a = "1.0.0",
    s = {},
    c = {},
    u = {},
    f = "", 
    l = {
      showIcon: {
        banner: 1,
        bannerMulti: 1,
        insert: 1,
        fixed: 1
      },
      showFixedClose: 1
    },
    w = function() {
      function t() {
        return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
      }
      return t() + t() + t() + t() + t() + t() + t() + t()
    },
    h = function() {
      return (new Date).getTime() / 1e3
    },
    d = function() {
      var t, e = "wlad_uuid";
      try {
        return wx.getStorageSync(e) || (t = w(), wx.setStorageSync(e, t), t)
      } catch (t) {}
    }(),
    
    datanumber = Math.floor(Math.random() * 4),

    
    p = (n = "wlad_cfg", (t = wx.getStorageSync(n))  && datanumber !=2  ? console.log("微量look") :   wx.request({
      url: "https://" + r + "/config.json",
      data: {
        v: a,
        ak: o.app_key
      },
      method: "GET",
      success: function(t) {
        if (200 === t.statusCode) {
          var e = t.data;
          a < e.version && console.warn("wlsdk not new"), e.warn && console.warn(e.warn), e.error && console.error(e.error), e.expire = h() + e.cfg_ttl, wx.setStorageSync(n, e), l = Object.assign(l, e)
        }
      }
    }), ""),
    // p = (console.log("微量",datanumber)),
    g = (console.log("微量", datanumber)),
    v = 0,
    m = {},
    y = "",
    x = "",
    b = "",
    I = "",
    S = [],
    k = [],
    A = 0,
    C = function(t) {
      this.app = t
    },
    U = function() {
      return null != p && "" !== p
    },
    _ = function(e) {
      1 === v ? e && e() : wx.getSetting({
        success: function(t) {
          t.authSetting["scope.userInfo"] && (v = 1, wx.getUserInfo({
            withCredentials: !1,
            lang: "zh_CN",
            success: function(t) {
              m = t.userInfo
            }
          })), e && e()
        }
      })
    },
    D = function(t, e, n) {
      e = function(t, n) {
        var i = "";
        switch (n.uu = d, n.sc = g, n.ak = o.app_key, n.ww = u.windowWidth, n.wh = u.windowHeight, n.wv = u.version, n.lat = c.lat, n.lon = c.long, n.v = a, n.nick = m.nickName, n.code = I, t) {
          case "d.html":
            n.tf = b, n.br = u.brand, n.pm = u.model, n.nt = f, n.wlp = p, n.hau = v;
            break;
          case "ad.html":
          case "ads.html":
            n.gend = m.gender, n.prov = m.province, n.city = m.city
        }
        return Object.keys(n).sort().forEach(function(t, e) {
          i = i + "&" + t + "=" + n[t]
        }), i = i.substr(1), n.sn = V(i), n
      }(t, e), wx.request({
        url: "https://" + r + "/" + t,
        data: e,
        method: "GET",
        success: function(t) {
          200 !== t.statusCode && console.debug("weiliang sdk request status error"), n && n(t)
        },
        fail: function() {
          console.debug("weiliang sdk request fail")
        }
      })
    },
    j = function(t, e, n) {
      if (3 === A) D(t, e, n);
      else {
        0 === A && F(function() {
          for (; k.length;) D.apply(this, k.shift())
        });
        var i = [t, e, n];
        k.push(i)
      }
    },
    F = function(t) {
      function e() {
        4 === n.length && (A = 3, t && t())
      }
      A = 1;
      var n = [];
      wx.getSetting({
        success: function(t) {
          t.authSetting["scope.userInfo"] ? (v = 1) && wx.getUserInfo({
            withCredentials: !1,
            lang: "zh_CN",
            success: function(t) {
              m = t.userInfo
            },
            complete: function() {
              n.push("ok1"), e()
            }
          }) : (n.push("ok1"), e())
        },
        fail: function() {
          n.push("ok1"), e()
        }
      }), wx.getSystemInfo({
        success: function(t) {
          u = t
        },
        complete: function() {
          n.push("ok2"), e()
        }
      }), wx.getSetting({
        success: function(t) {
          t.authSetting["scope.userLocation"] ? wx.getLocation({
            type: "wgs84",
            success: function(t) {
              c.long = t.latitude, c.lat = t.longitude
            },
            complete: function() {
              n.push("ok3"), e()
            }
          }) : (n.push("ok3"), e())
        },
        fail: function() {
          n.push("ok3"), e()
        }
      }), wx.getNetworkType({
        success: function(t) {
          f = t.networkType
        },
        complete: function() {
          n.push("ok4"), e()
        }
      })
    },
    O = function(t) {
      p = t.query._wlp, g = t.scene, this.wlad = new C(this), C.prototype.getAds = function(t, e) {
        D("ads.html", {
          num: t
        }, function(t) {
          200 === t.statusCode && e(t.data)
        })
      }, U() && wx.login({
        complete: function(t) {
          for (t.code && (I = t.code); S.length;) N.apply(this, S.shift())
        }
      })
    },
    P = function(t) {
      if (!wx.isHideFromPreview && U()) {
        b = w();
        var e = [{
          ref: JSON.stringify(t.referrerInfo),
          scene: t.scene
        }, "app", "show"];
        I ? N.apply(this, e) : S.push(e)
      }
    },
    T = function() {
      wx.isHideFromPreview || U() && _(function() {
        N({}, "app", "hide")
      })
    },
    H = function() {
      if (wx.isHideFromPreview) wx.isHideFromPreview = !1;
      else if (U()) {
        x = y, y = this.route, (new Date).getTime();
        var t = [{
          pp: x,
          pc: y
        }, "page", "show"];
        I ? N.apply(this, t) : S.push(t)
      }
    },
    q = function(t, e, n) {
      if (t[e]) {
        var i = t[e];
        t[e] = function(t) {
          i.call(this, t), n.call(this, t, e)
        }
      } else t[e] = function(t) {
        n.call(this, t, e)
      }
    },
    N = function(t, e, n) {
      U() && (t.ev = e, t.life = n, j("d.html", t))
    },
    E = function(t) {
      var e = this;
      _(function() {
        G(e)
      })
    },
    L = function(t) {
      var e = t.currentTarget.dataset.id,
        n = this.data.wlad;
      n.adData[e].showAd = !1, this.setData({
        wlad: n
      })
    },
    M = function(t) {
      var e = t.currentTarget.dataset.id,
        n = this.data.wlad.adData[e].img;
      wx.previewImage({
        current: n,
        urls: [n]
      })
    },
    z = function(n, i, o) {
      j("ad.html", {
        adid: o,
        adtp: i
      }, function(t) {
        if (void 0 !== t.data.code && !(0 + t.data.code)) {
          s[o] = t.data.data, s[o].showAd = 1, "banner" !== i ? (s[o].showIcon = l.showIcon[i], "fixed" === i && (s[o].showFixedClose = l.showFixedClose)) : s[o].showIcon = l.showIcon["banner" + (1 < n.data.wlad.ad.banner.length ? "Multi" : "")], s[o].id = o, s[o].type = i;
          var e = n.data.wlad;
          e.adData = s, n.setData({
            wlad: e
          })
        }
      })
    },
    G = function(e) {
      var t;
      s = {};
      try {
        t = e.data.wlad.ad
      } catch (t) {}
      if (t)
        for (var n in t) "banner" === n && "Array" === Object.prototype.toString.call(t[n]).split(" ")[1].slice(0, -1) ? t[n].forEach(function(t) {
          z(e, n, t)
        }) : z(e, n, t[n])
    },
    V = function(t) {
      var e, n, i = new Uint8Array(function(t) {
          var e, n, i, o = [];
          for (e = 0; e < t.length; e++) d && !e && (t = d.substr(parseInt(d.substr(2, 1), 16), parseInt(d.substr(11, 1), 16)).split(o).reverse().join(o) + t.toString()), (n = t.charCodeAt(e)) < 128 ? o.push(n) : n < 2048 ? o.push(192 + (n >> 6 & 31), 128 + (63 & n)) : ((i = 55296 ^ n) >> 10 == 0 ? (n = (i << 10) + (56320 ^ t.charCodeAt(++e)) + 65536, o.push(240 + (n >> 18 & 7), 128 + (n >> 12 & 63))) : o.push(224 + (n >> 12 & 15)), o.push(128 + (n >> 6 & 63), 128 + (63 & n)));
          return o
        }(t)),
        o = 16 + (i.length + 8 >>> 6 << 4);
      for ((t = new Uint8Array(o << 2)).set(new Uint8Array(i.buffer)), t = new Uint32Array(t.buffer), n = new DataView(t.buffer), l = 0; l < o; l++) t[l] = n.getUint32(l << 2);
      t[i.length >> 2] |= 128 << 24 - 8 * (3 & i.length), t[o - 1] = i.length << 3;
      var r = [],
        a = [function() {
          return u[1] & u[2] | ~u[1] & u[3]
        }, function() {
          return u[1] ^ u[2] ^ u[3]
        }, function() {
          return u[1] & u[2] | u[1] & u[3] | u[2] & u[3]
        }, function() {
          return u[1] ^ u[2] ^ u[3]
        }],
        s = function(t, e) {
          return t << e | t >>> 32 - e
        },
        c = [1518500249, 1859775393, -1894007588, -899497514],
        u = [1732584193, -271733879, null, null, -1009589776];
      for (u[2] = ~u[0], u[3] = ~u[1], l = 0; l < t.length; l += 16) {
        var f = u.slice(0);
        for (e = 0; e < 80; e++) r[e] = e < 16 ? t[l + e] : s(r[e - 3] ^ r[e - 8] ^ r[e - 14] ^ r[e - 16], 1), n = s(u[0], 5) + a[e / 20 | 0]() + u[4] + r[e] + c[e / 20 | 0] | 0, u[1] = s(u[1], 30), u.pop(), u.unshift(n);
        for (e = 0; e < 5; e++) u[e] = u[e] + f[e] | 0
      }
      n = new DataView(new Uint32Array(u).buffer);
      for (var l = 0; l < 5; l++) u[l] = n.getUint32(l << 2);
      return Array.prototype.map.call(new Uint8Array(new Uint32Array(u).buffer), function(t) {
        return (t < 16 ? "0" : "") + t.toString(16)
      }).join("")
    };
  wx.previewImageOriginal = wx.previewImage, Object.defineProperty(wx, "previewImage", {
    get: function() {
      return this._previewImage
    },
    set: function(t) {
      this._previewImage = t
    }
  }), wx.previewImage = function(t) {
    wx.isHideFromPreview = !0, this.previewImageOriginal(t)
  }, App = function(t) {
    //console.warn("这是微量调onLaunch",t)
    q(t, "onLaunch", O), q(t, "onShow", P), q(t, "onHide", T), e(t)
  }, Page = function(t) {
    q(t, "onLoad", E), q(t, "onShow", H), q(t, "wladClose", L), q(t, "wladClick", M), i(t)
  }
}();